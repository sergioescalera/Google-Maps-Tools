var __extends,Google,RulerDemo;(function(n){var t;(function(n){"use strict";var t={ruler:function(){return"<div class='ruler-wrapper'>\n            <label for='rulerToggle'>Measure distance<\/label><input id='rulerToggle' type='checkbox' /><\/div>"},rulerPopup:function(){return"<div class='ruler-popup-wrapper'>\n                <div class='ruler-title'>Measure distance<\/div>\n                <div class='ruler-instructions'>Click on the map to trace a path you want to measure<\/div>\n                <div class='ruler-distance'>Total distance:\n                    <span class='ruler-distance-miles'><\/span>\n                    <span class='ruler-distance-km'><\/span><\/div>\n            <\/div>"}},i=function(){function i(n,i,r){i===void 0&&(i=google.maps.ControlPosition.TOP_LEFT);r===void 0&&(r=google.maps.ControlPosition.BOTTOM_CENTER);this.on=!1;this._map=n;this._toggleControl=jQuery(t.ruler());this._toggleControl.find("[type=checkbox]").click(this.TogglePopup.bind(this));this._popupControl=jQuery(t.rulerPopup()).hide();this._distanceControl=this._popupControl.find(".ruler-distance");this._distanceMilesControl=this._popupControl.find(".ruler-distance-miles");this._distanceKmControl=this._popupControl.find(".ruler-distance-km");this._map.controls[i].push(this._toggleControl.get(0));this._map.controls[r].push(this._popupControl.get(0));this._map.addListener("click",this.AddPoint.bind(this));this.Reset();this.UpdateDistance()}return Object.defineProperty(i.prototype,"poly",{get:function(){if(!this._poly){this._poly=new google.maps.Polyline({editable:!0,strokeColor:"#000",strokeOpacity:1,strokeWeight:2.5});this._poly.setMap(this._map);var n=this._poly.getPath();google.maps.event.addListener(n,"insert_at",this.CalculateDistance.bind(this));google.maps.event.addListener(n,"remove_at",this.CalculateDistance.bind(this));google.maps.event.addListener(n,"set_at",this.CalculateDistance.bind(this))}return this._poly},enumerable:!0,configurable:!0}),i.prototype.AddPoint=function(n){if(this.on){var t=n.latLng;this.poly.getPath().push(t)}},i.prototype.CalculateDistance=function(){var r,t,i,n;if(this._poly){for(r=this._poly.getPath(),t=r.getArray(),this._distances=[],i=0,n=1;n<t.length;n++){var u=t[n-1],f=t[n],e=google.maps.geometry.spherical.computeDistanceBetween(u,f)*.001;i+=e;this._distances.push(i)}this.UpdateDistance()}},i.prototype.ClearTooltips=function(){this._tooltips&&this._tooltips.forEach(function(n){return n.setMap(null)});this._tooltips=[]},i.prototype.Reset=function(){this._poly&&this._poly.setMap(null);this._poly=null;this._distances=[];this.ClearTooltips()},i.prototype.TogglePopup=function(){this._popupControl.toggle(100);this.on=!this.on;this.on||(this.Reset(),this.UpdateDistance())},i.prototype.UpdateDistance=function(){var u,i,t,r;if(this._distances.length===0?this._distanceControl.hide():this._distanceControl.show(),this.ClearTooltips(),this._poly)for(u=this._poly.getPath(),i=u.getArray(),t=1;t<i.length;t++){var f=i[t],e=this._distances[t-1]*.62137119,o=e.toFixed(2)+" miles",s=new n.RulerTooltip(f,o,this._map);this._tooltips.push(s)}r=this._distances.length>0?this._distances[this._distances.length-1]:0;this._distanceKmControl.text("("+r.toFixed(2)+" km)");this._distanceMilesControl.text((r*.62137119).toFixed(2)+" miles")},i}();n.Ruler=i})(t=n.Maps||(n.Maps={}))})(Google||(Google={}));__extends=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)},function(n){var t;(function(n){"use strict";var t="<div class='ruler-tooltip'><\/div>",i=function(n){function i(t,i,r){n.call(this);this._location=t;this._text=i;this.setMap(r)}return __extends(i,n),i.prototype.draw=function(){var i=this.getProjection(),n=i.fromLatLngToDivPixel(this._location),t={left:n.x+"px",top:n.y+"px"};console.log(t);this._container.css(t)},i.prototype.onAdd=function(){this._container=jQuery(t).html(this._text);this.getPanes().overlayLayer.appendChild(this._container.get(0))},i.prototype.onRemove=function(){this._container&&this._container.remove()},i}(google.maps.OverlayView);n.RulerTooltip=i})(t=n.Maps||(n.Maps={}))}(Google||(Google={})),function(n){function s(){h();c()}function h(){i=new google.maps.LatLng(u,f);r=document.getElementById("map-canvas");t=new google.maps.Map(r,{zoom:e,center:i,zoomControl:!0,scaleControl:!0,mapTypeControl:!0,rotateControl:!0,draggable:!0,draggableCursor:"default",draggingCursor:"move",mapTypeId:google.maps.MapTypeId.ROADMAP})}function c(){o=new Google.Maps.Ruler(t)}var u=38,f=-100,e=8,t,i,r,o;n.init=s}(RulerDemo||(RulerDemo={}));